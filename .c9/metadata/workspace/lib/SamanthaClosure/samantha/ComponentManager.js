{"filter":false,"title":"ComponentManager.js","tooltip":"/lib/SamanthaClosure/samantha/ComponentManager.js","undoManager":{"mark":37,"position":37,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":195,"column":0},"action":"insert","lines":["// Copyright (c) 2009-2012 Techinox Information Technologies (http://www.techinox.com)","// Techinox Commercial License","//","// @author Armagan Amcalar <armagan.amcalar@tart.com.tr>","","","goog.provide('tart.ui.ComponentManager');","goog.require('tart.events');","goog.require('goog.array');","goog.require('goog.events.EventType');","goog.require('tart.events.HoverHandler');","goog.require('tart.events.GestureHandler');","","/**"," * @fileoverview Registry for tart.ui.DlgComponent. Manages DOM event interactions for these components."," */","","","/**"," *"," * @constructor"," */","tart.ui.ComponentManager = function() {","    /** @type {Object.<string, tart.ui.DlgComponent>} */","    this.components = {};","    this.gestureHandler = tart.events.GestureHandler.getInstance();","    this.hoverHandler = new tart.events.HoverHandler();","","    goog.events.listen(document.body, tart.ui.ComponentManager.eventTypes, this);","    goog.events.listen(this.hoverHandler, [tart.events.EventType.MOUSEENTER, tart.events.EventType.MOUSELEAVE], this);","};","goog.addSingletonGetter(tart.ui.ComponentManager);","","","/**"," * Returns parent components (if available) of a given DOM node."," *"," * @private"," *"," * @param {Node} child DOM node that will be used for finding parent components."," * @return {Array.<tart.ui.DlgComponent>} Parent components."," */","tart.ui.ComponentManager.prototype.getParentComponents_ = function(child) {","    var node = child, cmps = [], cmp, ids;","","    if (ids = node.getAttribute && node.getAttribute('data-cmp')) {","        ids.split(',').forEach(function(id) {","            if (id) cmps.push(this.components[id]);","        }, this);","","        return cmps;","    }","","    ids = [];","","    do {","        if (cmp = this.components[node.id]) {","            cmps.push(cmp);","            ids.push(node.id);","        }","    } while (node = node.parentNode);","","    child.setAttribute('data-cmp', ids.join(','));","    return cmps;","};","","","/**"," * Keeps event types."," * @type {Array.<goog.events.EventType>}"," */","tart.ui.ComponentManager.eventTypes = [","    goog.events.EventType.CLICK,","    goog.events.EventType.MOUSEOVER,","    goog.events.EventType.MOUSEOUT,","    goog.events.EventType.MOUSEMOVE,","    goog.events.EventType.MOUSEDOWN,","    goog.events.EventType.MOUSEUP,","    tart.events.EventType.MOUSEENTER,","    tart.events.EventType.MOUSELEAVE,","    tart.events.EventType.TAP,","    tart.events.EventType.SWIPE_LEFT,","    tart.events.EventType.SWIPE_RIGHT,","    tart.events.EventType.SWIPE_UP,","    tart.events.EventType.SWIPE_DOWN,","    goog.events.EventType.SCROLL,","    goog.events.EventType.KEYUP,","    goog.events.EventType.FOCUSIN,","    goog.events.EventType.FOCUSOUT,","    goog.events.EventType.TOUCHSTART,","    goog.events.EventType.TOUCHMOVE,","    goog.events.EventType.TOUCHEND","];","","","/**"," * @param {goog.events.BrowserEvent} e Browser event to be executed."," */","tart.ui.ComponentManager.prototype.handleEvent = function (e) {","    var cmps = this.getParentComponents_(e.target),","        broken = false;","","    do {","        if (broken) break;","","        if (e.type == tart.events.EventType.MOUSEENTER || e.type == tart.events.EventType.MOUSELEAVE) {","            if (e.relatedTarget && !goog.dom.contains(e.target, e.relatedTarget)) {","                broken = this.callHandlers_(cmps, e);","            }","        }","        else {","            broken = this.callHandlers_(cmps, e);","        }","    } while (e.target = e.target.parentNode);","};","","","/**"," * Given a list of components, checks whether any component would respond to the given event and if so, executes the"," * event handler defined in the component."," *"," * @private"," *"," * @param {Array.<tart.ui.DlgComponent>} cmps Array of components to look for handlers about the event's target."," * @param {goog.events.BrowserEvent} e Browser event that will be executed for the target."," */","tart.ui.ComponentManager.prototype.callHandlers_ = function(cmps, e) {","    var broken = false;","","    for (var i = 0; i < cmps.length; i++) {","        var cmp = cmps[i];","        var handlers = cmp && cmp.events && cmp.events[e.type];","","        if (!handlers) continue;","","        var selectors = goog.object.getKeys(handlers);","","        if (this.callHandler_(cmp, e, handlers, selectors) === false) {","            broken = true;","            break;","        }","    }","","    return broken;","};","","","/**"," * @private"," *"," * @param cmp"," * @param e"," * @param handlers"," * @param selectors"," * @return {boolean}"," */","tart.ui.ComponentManager.prototype.callHandler_ = function(cmp, e, handlers, selectors){","    var rv = true;","    goog.array.forEach(selectors, function(selector) {","        // event's target equals to handler's selector","        if (this.matchesSelector(e.target, selector)) {","            rv = handlers[selector].call(cmp, e);","        }","    }, this);","    return rv;","};","","","/**"," *"," * @param el"," * @param selector"," * @return {*}"," */","tart.ui.ComponentManager.prototype.matchesSelector = function(el, selector) {","    return goog.array.indexOf(goog.dom.query(selector), el) >= 0;","};","","","/**"," * Set given component."," * @param {tart.ui.DlgComponent} cmp Component which will be set to components."," */","tart.ui.ComponentManager.prototype.set = function(cmp) {","    this.components[cmp.getId()] = cmp;","};","","","/**"," * Removes given component."," * @param {tart.ui.DlgComponent} cmp Component which will be removed from components."," */","tart.ui.ComponentManager.prototype.remove = function(cmp) {","    delete this.components[cmp.getId()];","};",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":1},"end":{"row":5,"column":0},"action":"remove","lines":["/ Copyright (c) 2009-2012 Techinox Information Technologies (http://www.techinox.com)","// Techinox Commercial License","//","// @author Armagan Amcalar <armagan.amcalar@tart.com.tr>","",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":14},"end":{"row":0,"column":18},"action":"remove","lines":["tart"]},{"start":{"row":0,"column":14},"end":{"row":0,"column":29},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":14},"end":{"row":1,"column":18},"action":"remove","lines":["tart"]},{"start":{"row":1,"column":14},"end":{"row":1,"column":29},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":14},"end":{"row":4,"column":18},"action":"remove","lines":["tart"]},{"start":{"row":4,"column":14},"end":{"row":4,"column":29},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":5,"column":14},"end":{"row":5,"column":18},"action":"remove","lines":["tart"]},{"start":{"row":5,"column":14},"end":{"row":5,"column":29},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":30},"end":{"row":8,"column":34},"action":"remove","lines":["tart"]},{"start":{"row":8,"column":30},"end":{"row":8,"column":45},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":0},"end":{"row":16,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":16,"column":0},"end":{"row":16,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":31},"end":{"row":17,"column":35},"action":"remove","lines":["tart"]},{"start":{"row":17,"column":31},"end":{"row":17,"column":46},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":26},"end":{"row":19,"column":30},"action":"remove","lines":["tart"]},{"start":{"row":19,"column":26},"end":{"row":19,"column":41},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":28},"end":{"row":20,"column":32},"action":"remove","lines":["tart"]},{"start":{"row":20,"column":28},"end":{"row":20,"column":43},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":38},"end":{"row":22,"column":42},"action":"remove","lines":["tart"]},{"start":{"row":22,"column":38},"end":{"row":22,"column":53},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":43},"end":{"row":23,"column":47},"action":"remove","lines":["tart"]},{"start":{"row":23,"column":43},"end":{"row":23,"column":58},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":88},"end":{"row":23,"column":92},"action":"remove","lines":["tart"]},{"start":{"row":23,"column":88},"end":{"row":23,"column":103},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":25,"column":24},"end":{"row":25,"column":28},"action":"remove","lines":["tart"]},{"start":{"row":25,"column":24},"end":{"row":25,"column":39},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":34,"column":19},"end":{"row":34,"column":23},"action":"remove","lines":["tart"]},{"start":{"row":34,"column":19},"end":{"row":34,"column":34},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":0},"end":{"row":36,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":36,"column":0},"end":{"row":36,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":0},"end":{"row":65,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":65,"column":0},"end":{"row":65,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":72,"column":4},"end":{"row":72,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":72,"column":4},"end":{"row":72,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":73,"column":4},"end":{"row":73,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":73,"column":4},"end":{"row":73,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":74,"column":4},"end":{"row":74,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":74,"column":4},"end":{"row":74,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":75,"column":4},"end":{"row":75,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":75,"column":4},"end":{"row":75,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":76,"column":4},"end":{"row":76,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":76,"column":4},"end":{"row":76,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":4},"end":{"row":77,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":77,"column":4},"end":{"row":77,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":78,"column":4},"end":{"row":78,"column":8},"action":"remove","lines":["tart"]},{"start":{"row":78,"column":4},"end":{"row":78,"column":19},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":92,"column":0},"end":{"row":92,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":92,"column":0},"end":{"row":92,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":99,"column":22},"end":{"row":99,"column":26},"action":"remove","lines":["tart"]},{"start":{"row":99,"column":22},"end":{"row":99,"column":37},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":99,"column":79},"end":{"row":99,"column":83},"action":"remove","lines":["tart"]},{"start":{"row":99,"column":79},"end":{"row":99,"column":94},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":117,"column":18},"end":{"row":117,"column":22},"action":"remove","lines":["tart"]},{"start":{"row":117,"column":18},"end":{"row":117,"column":33},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":120,"column":0},"end":{"row":120,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":120,"column":0},"end":{"row":120,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":150,"column":0},"end":{"row":150,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":150,"column":0},"end":{"row":150,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":168,"column":0},"end":{"row":168,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":168,"column":0},"end":{"row":168,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":175,"column":11},"end":{"row":175,"column":15},"action":"remove","lines":["tart"]},{"start":{"row":175,"column":11},"end":{"row":175,"column":26},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":177,"column":0},"end":{"row":177,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":177,"column":0},"end":{"row":177,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":184,"column":11},"end":{"row":184,"column":15},"action":"remove","lines":["tart"]},{"start":{"row":184,"column":11},"end":{"row":184,"column":26},"action":"insert","lines":["SamanthaClosure"]}]}],[{"group":"doc","deltas":[{"start":{"row":186,"column":0},"end":{"row":186,"column":4},"action":"remove","lines":["tart"]},{"start":{"row":186,"column":0},"end":{"row":186,"column":15},"action":"insert","lines":["SamanthaClosure"]}]}]]},"ace":{"folds":[],"scrolltop":2748,"scrollleft":0,"selection":{"start":{"row":189,"column":0},"end":{"row":189,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1425207889645,"hash":"8e11840a622bdd2b2f50367490476e3888131db1"}